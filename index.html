<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shaikh's Enhanced Arcade</title>
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700&family=Fredoka+One&display=swap" rel="stylesheet">
  <style>
    /* ===== CSS Variables - Enhanced Theme with Softer Colors ===== */
    :root {
      /* Light Theme (Default) - Softer, Pastel Palette */
      --color-primary: #8A9BA8; /* Soft Blue-Grey */
      --color-on-primary: #ffffff;
      --color-secondary: #A8E6CF; /* Soft Mint Green */
      --color-on-secondary: #2d3436;
      --color-tertiary: #FFD3B6; /* Soft Peach */
      --color-on-tertiary: #2d3436;
      --color-surface: #ffffff;
      --color-on-surface: #2d3436;
      --color-background: #f8f9fa; /* Very light grey */
      --color-on-background: #2d3436;
      --color-error: #ff6b6b; /* Soft Red */
      --color-on-error: #ffffff;
      --color-success: #A8E6CF; /* Soft Green */
      --color-on-success: #2d3436;
      --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.08), 0 1px 2px rgba(0, 0, 0, 0.12);
      --shadow-md: 0 3px 6px rgba(0, 0, 0, 0.12), 0 3px 6px rgba(0, 0, 0, 0.16);
      --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.15), 0 6px 6px rgba(0, 0, 0, 0.15);
      --shadow-focus: 0 0 0 3px rgba(138, 155, 168, 0.3);
      --transition-fast: 0.1s;
      --transition-normal: 0.2s;
      --transition-slow: 0.3s;
      --border-radius-sm: 4px;
      --border-radius-md: 8px;
      --border-radius-lg: 12px;
      --spacing-xs: 4px;
      --spacing-sm: 8px;
      --spacing-md: 16px;
      --spacing-lg: 24px;
      --spacing-xl: 32px;
      --spacing-xxl: 48px;
      --font-family-base: 'Nunito', 'Helvetica Neue', Arial, sans-serif;
      --font-family-heading: 'Fredoka One', cursive;
      --z-sidebar: 100;
      --z-modal: 1000;
      --z-toast: 1100;
    }

    /* Dark Theme - Softer, Warmer */
    .theme-dark {
      --color-primary: #a0b3c6; /* Softer Light Blue */
      --color-on-primary: #121212;
      --color-secondary: #8ac9a0; /* Softer Sage Green */
      --color-on-secondary: #121212;
      --color-tertiary: #e6b89c; /* Softer Apricot */
      --color-on-tertiary: #121212;
      --color-surface: #1e1e24; /* Darker surface */
      --color-on-surface: #e0e0e0;
      --color-background: #121218; /* Darker background */
      --color-on-background: #e0e0e0;
      --color-error: #ff7b7b; /* Softer Coral Red */
      --color-success: #8ac9a0; /* Softer Sage Green */
      --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.2), 0 1px 2px rgba(0, 0, 0, 0.25);
      --shadow-md: 0 3px 6px rgba(0, 0, 0, 0.25), 0 3px 6px rgba(0, 0, 0, 0.3);
      --shadow-lg: 0 10px 20px rgba(0, 0, 0, 0.25), 0 6px 6px rgba(0, 0, 0, 0.25);
      --shadow-focus: 0 0 0 3px rgba(160, 179, 198, 0.3);
    }

    /* ===== Base Styles ===== */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: var(--font-family-base);
      background-color: var(--color-background);
      color: var(--color-on-background);
      line-height: 1.6;
      overflow-x: hidden;
      transition: background-color var(--transition-normal), color var(--transition-normal);
      position: relative;
      min-height: 100vh;
    }

    /* Doodle Background */
    body::before {
      content: "";
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-image: 
        radial-gradient(circle at 10% 20%, rgba(168, 230, 207, 0.15) 0%, transparent 20%),
        radial-gradient(circle at 90% 80%, rgba(255, 211, 182, 0.15) 0%, transparent 20%),
        radial-gradient(circle at 30% 70%, rgba(138, 155, 168, 0.1) 0%, transparent 15%),
        radial-gradient(circle at 70% 30%, rgba(138, 155, 168, 0.1) 0%, transparent 15%);
      pointer-events: none;
      z-index: -1;
    }

    .theme-dark::before {
      background-image: 
        radial-gradient(circle at 10% 20%, rgba(138, 201, 160, 0.1) 0%, transparent 20%),
        radial-gradient(circle at 90% 80%, rgba(230, 184, 156, 0.1) 0%, transparent 20%),
        radial-gradient(circle at 30% 70%, rgba(160, 179, 198, 0.08) 0%, transparent 15%),
        radial-gradient(circle at 70% 30%, rgba(160, 179, 198, 0.08) 0%, transparent 15%);
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: var(--spacing-md);
    }

    /* ===== Buttons ===== */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: var(--spacing-sm) var(--spacing-md);
      border: none;
      border-radius: var(--border-radius-md);
      font-family: var(--font-family-base);
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all var(--transition-fast);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      position: relative;
      overflow: hidden;
      outline: none;
      text-decoration: none;
    }

    .btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .btn:focus {
      box-shadow: var(--shadow-focus);
    }

    .btn-primary {
      background-color: var(--color-primary);
      color: var(--color-on-primary);
      box-shadow: var(--shadow-sm);
    }

    .btn-primary:hover {
      background-color: color-mix(in srgb, var(--color-primary) 85%, black);
      box-shadow: var(--shadow-md);
    }

    .btn-secondary {
      background-color: var(--color-surface);
      color: var(--color-on-surface);
      border: 1px solid rgba(0, 0, 0, 0.1);
      box-shadow: var(--shadow-sm);
    }

    .theme-dark .btn-secondary {
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .btn-secondary:hover {
      background-color: rgba(0, 0, 0, 0.03);
      box-shadow: var(--shadow-md);
    }

    .theme-dark .btn-secondary:hover {
      background-color: rgba(255, 255, 255, 0.03);
    }

    .icon-button {
      background: none;
      border: none;
      font-size: 1.2rem;
      cursor: pointer;
      padding: var(--spacing-sm);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: background-color var(--transition-fast);
    }

    .icon-button:hover {
      background-color: rgba(0, 0, 0, 0.05);
    }

    .theme-dark .icon-button:hover {
      background-color: rgba(255, 255, 255, 0.05);
    }

    /* ===== Header ===== */
    header {
      background-color: var(--color-surface);
      box-shadow: var(--shadow-sm);
      position: sticky;
      top: 0;
      z-index: 100;
      padding: var(--spacing-md) 0;
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 var(--spacing-md);
    }

    .logo {
      font-family: var(--font-family-heading);
      font-size: 1.8rem;
      font-weight: 400;
      color: var(--color-primary);
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
    }

    .logo-icon {
      font-size: 2rem;
      animation: float-subtle 3s ease-in-out infinite alternate;
    }

    .header-controls {
      display: flex;
      gap: var(--spacing-sm);
    }

    /* ===== Search ===== */
    .search-container {
      position: relative;
      max-width: 400px;
      margin: var(--spacing-md) auto;
      width: 100%;
    }

    .search-icon {
      position: absolute;
      left: var(--spacing-md);
      top: 50%;
      transform: translateY(-50%);
      color: var(--color-on-surface);
      opacity: 0.6;
    }

    .search-input {
      width: 100%;
      padding: var(--spacing-sm) var(--spacing-md) var(--spacing-sm) calc(var(--spacing-xl) + var(--spacing-sm));
      border-radius: var(--border-radius-md);
      border: 1px solid rgba(0, 0, 0, 0.1);
      background-color: var(--color-surface);
      color: var(--color-on-surface);
      font-family: var(--font-family-base);
      font-size: 1rem;
      box-shadow: var(--shadow-sm);
      transition: box-shadow var(--transition-fast);
    }

    .theme-dark .search-input {
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .search-input:focus {
      outline: none;
      box-shadow: var(--shadow-focus);
    }

    /* ===== Main Layout ===== */
    .game-area {
      display: flex;
      gap: var(--spacing-lg);
      margin-top: var(--spacing-md);
    }

    /* ===== Sidebar ===== */
    .game-sidebar {
      width: 300px;
      background-color: var(--color-surface);
      border-radius: var(--border-radius-lg);
      box-shadow: var(--shadow-sm);
      padding: var(--spacing-md);
      overflow-y: auto;
      max-height: calc(100vh - 200px);
      transition: transform var(--transition-normal);
      z-index: var(--z-sidebar);
      border: 1px solid rgba(0, 0, 0, 0.1);
      position: sticky;
      top: 100px;
      align-self: flex-start;
    }

    .theme-dark .game-sidebar {
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .game-sidebar.hidden {
      transform: translateX(-110%);
      position: absolute;
    }

    .sidebar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--spacing-md);
      padding-bottom: var(--spacing-sm);
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    }

    .theme-dark .sidebar-header {
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .sidebar-title {
      font-family: var(--font-family-heading);
      font-size: 1.5rem;
      font-weight: 400;
      margin: 0;
      color: var(--color-primary);
    }

    .toggle-sidebar {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      padding: var(--spacing-xs);
      border-radius: var(--border-radius-sm);
      transition: background-color var(--transition-fast);
      display: none;
    }

    .toggle-sidebar:hover {
      background-color: rgba(0, 0, 0, 0.05);
    }

    .theme-dark .toggle-sidebar:hover {
      background-color: rgba(255, 255, 255, 0.1);
    }

    .games-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .game-list-item {
      padding: var(--spacing-sm) var(--spacing-md);
      margin-bottom: var(--spacing-xs);
      border-radius: var(--border-radius-md);
      cursor: pointer;
      transition: background-color var(--transition-fast);
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
    }

    .game-list-item:hover {
      background-color: rgba(0, 0, 0, 0.05);
    }

    .theme-dark .game-list-item:hover {
      background-color: rgba(255, 255, 255, 0.05);
    }

    .game-list-item.active {
      background-color: rgba(138, 155, 168, 0.15); /* Primary color with opacity */
      font-weight: 600;
    }

    .game-list-icon {
      font-size: 1.5rem;
    }

    .game-list-text {
      flex: 1;
      color: var(--color-on-surface);
    }

    /* ===== Main Content ===== */
    .games-main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      min-height: 0;
    }

    .games-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: var(--spacing-lg);
      margin-bottom: var(--spacing-xl);
      flex: 1;
      overflow-y: auto;
      padding: var(--spacing-sm);
    }

    .game-tile {
      background-color: var(--color-surface);
      border-radius: var(--border-radius-lg);
      padding: var(--spacing-lg);
      cursor: pointer;
      transition: transform var(--transition-fast), box-shadow var(--transition-fast);
      position: relative;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      box-shadow: var(--shadow-sm);
      border: 1px solid rgba(0, 0, 0, 0.05);
    }

    .game-tile:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow-md);
    }

    .game-tile::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: linear-gradient(90deg, var(--color-primary) 0%, var(--color-secondary) 100%);
      transform: scaleX(0);
      transform-origin: left;
      transition: transform var(--transition-normal);
    }

    .game-tile:hover::before {
      transform: scaleX(1);
    }

    .game-icon {
      width: 70px;
      height: 70px;
      margin-bottom: var(--spacing-md);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      border-radius: var(--border-radius-md);
      background-color: var(--color-primary);
      color: var(--color-on-primary);
      transition: transform var(--transition-normal);
      position: relative;
      box-shadow: var(--shadow-md);
      animation: float-subtle 3s ease-in-out infinite alternate;
    }

    @keyframes float-subtle {
      from { transform: translateY(0px); }
      to { transform: translateY(-5px); }
    }

    .game-tile:hover .game-icon {
      animation: wiggle 0.6s ease;
    }

    @keyframes wiggle {
      0%, 100% { transform: rotate(-3deg); }
      50% { transform: rotate(3deg); }
    }

    .game-title {
      font-family: var(--font-family-heading);
      font-size: 1.25rem;
      font-weight: 400;
      margin-bottom: var(--spacing-xs);
      color: var(--color-on-surface);
    }

    .game-description {
      font-size: 0.875rem;
      color: var(--color-on-surface);
      opacity: 0.7;
      transform: translateY(0);
      transition: transform var(--transition-normal);
    }

    .game-tile:hover .game-description {
      transform: translateY(-3px);
    }

    .game-preview {
      margin-top: var(--spacing-md);
      height: 100px;
      background-color: rgba(0, 0, 0, 0.03);
      border-radius: var(--border-radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.875rem;
      color: var(--color-on-surface);
      opacity: 0.6;
      transition: opacity var(--transition-normal);
    }

    .theme-dark .game-preview {
      background-color: rgba(255, 255, 255, 0.03);
    }

    .game-tile:hover .game-preview {
      opacity: 0.8;
    }

    /* ===== Game View ===== */
    .game-view {
      display: none;
      background-color: var(--color-surface);
      border-radius: var(--border-radius-lg);
      box-shadow: var(--shadow-sm);
      overflow: hidden;
      height: calc(100vh - 160px);
      flex-direction: column;
      margin-top: var(--spacing-md);
      border: 1px solid rgba(0, 0, 0, 0.1);
    }

    .theme-dark .game-view {
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .game-view.active {
      display: flex;
    }

    .game-header {
      padding: var(--spacing-md);
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .theme-dark .game-header {
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .game-title-bar {
      display: flex;
      align-items: center;
      gap: var(--spacing-lg);
    }

    .game-title {
      font-family: var(--font-family-heading);
      font-size: 1.5rem;
      font-weight: 400;
      margin: 0;
      color: var(--color-primary);
    }

    .game-controls {
      display: flex;
      gap: var(--spacing-sm);
    }

    .game-content {
      flex: 1;
      overflow-y: auto;
      padding: var(--spacing-lg);
      outline: none;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    /* ===== Game Styles ===== */
    /* Snake Game */
    .snake-game {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--spacing-lg);
      width: 100%;
      max-width: 500px;
    }

    .snake-canvas-container {
      position: relative;
      width: 100%;
      max-width: 400px;
    }

    .snake-canvas {
      background-color: #f0f0f0;
      border-radius: var(--border-radius-md);
      box-shadow: var(--shadow-sm);
      display: block;
      width: 100%;
      height: auto;
    }

    .theme-dark .snake-canvas {
      background-color: #2a2a30;
    }

    .snake-stats {
      display: flex;
      gap: var(--spacing-lg);
      font-size: 1rem;
      font-weight: 600;
      flex-wrap: wrap;
      justify-content: center;
    }

    .snake-stat-item {
      background-color: rgba(0, 0, 0, 0.03);
      padding: var(--spacing-sm) var(--spacing-md);
      border-radius: var(--border-radius-sm);
      display: flex;
      align-items: center;
      gap: var(--spacing-xs);
    }

    .theme-dark .snake-stat-item {
      background-color: rgba(255, 255, 255, 0.03);
    }

    .snake-level-display {
      font-weight: 600;
      color: var(--color-primary);
    }

    .snake-announcer {
      min-height: 24px;
      font-weight: 600;
      text-align: center;
      color: var(--color-primary);
      font-size: 1.1rem;
    }

    /* Tic-Tac-Toe Game */
    .tictactoe-game {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--spacing-lg);
      width: 100%;
      max-width: 400px;
    }

    .tictactoe-status {
      font-size: 1.2rem;
      font-weight: 600;
      text-align: center;
      min-height: 30px;
    }

    .tictactoe-board {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: var(--spacing-sm);
      width: 100%;
      max-width: 300px;
    }

    .tictactoe-cell {
      aspect-ratio: 1;
      background-color: rgba(0, 0, 0, 0.03);
      border-radius: var(--border-radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.5rem;
      font-weight: 700;
      cursor: pointer;
      transition: background-color var(--transition-fast), transform var(--transition-fast);
      box-shadow: var(--shadow-sm);
      border: 1px solid rgba(0, 0, 0, 0.05);
    }

    .theme-dark .tictactoe-cell {
      background-color: rgba(255, 255, 255, 0.03);
      border: 1px solid rgba(255, 255, 255, 0.05);
    }

    .tictactoe-cell:hover:not(.win) {
      background-color: rgba(0, 0, 0, 0.08);
      transform: scale(1.05);
    }

    .theme-dark .tictactoe-cell:hover:not(.win) {
      background-color: rgba(255, 255, 255, 0.08);
    }

    .tictactoe-cell.win {
      background-color: rgba(168, 230, 207, 0.4);
      animation: pulse 0.5s ease-in-out;
    }

    .theme-dark .tictactoe-cell.win {
      background-color: rgba(138, 201, 160, 0.4);
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }

    .tictactoe-score {
      font-size: 1rem;
      font-weight: 600;
      text-align: center;
      margin: var(--spacing-md) 0;
    }

    .tictactoe-controls {
      display: flex;
      gap: var(--spacing-sm);
      margin-top: var(--spacing-sm);
      flex-wrap: wrap;
      justify-content: center;
    }

    .tictactoe-mode-selector {
      display: flex;
      gap: var(--spacing-sm);
      align-items: center;
      margin-bottom: var(--spacing-sm);
      flex-wrap: wrap;
      justify-content: center;
    }

    .tictactoe-mode-selector .btn {
      font-size: 0.8rem;
      padding: var(--spacing-xs) var(--spacing-sm);
    }

    .tictactoe-mode-selector .btn.active {
      background-color: var(--color-primary);
      color: var(--color-on-primary);
    }

    /* Memory Game */
    .memory-game {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--spacing-lg);
      width: 100%;
      max-width: 500px;
    }

    .memory-stats {
      display: flex;
      gap: var(--spacing-lg);
      font-size: 1rem;
      font-weight: 600;
      flex-wrap: wrap;
      justify-content: center;
    }

    .memory-stat-item {
      background-color: rgba(0, 0, 0, 0.03);
      padding: var(--spacing-sm) var(--spacing-md);
      border-radius: var(--border-radius-sm);
    }

    .theme-dark .memory-stat-item {
      background-color: rgba(255, 255, 255, 0.03);
    }

    .memory-board {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: var(--spacing-sm);
      width: 100%;
      max-width: 320px;
    }

    .memory-card {
      aspect-ratio: 1;
      background: linear-gradient(135deg, var(--color-primary), var(--color-secondary));
      border-radius: var(--border-radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
      cursor: pointer;
      transition: transform var(--transition-fast);
      box-shadow: var(--shadow-sm);
      position: relative;
      overflow: hidden;
    }

    .memory-card::before {
      content: "?";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: var(--color-tertiary);
      color: var(--color-on-tertiary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
      transition: transform var(--transition-fast);
      transform: rotateY(0deg);
      backface-visibility: hidden;
    }

    .memory-card.flipped::before {
      transform: rotateY(180deg);
    }

    .memory-card.flipped {
      background: linear-gradient(135deg, var(--color-surface), var(--color-surface));
    }

    .memory-card.matched {
      background: linear-gradient(135deg, var(--color-success), var(--color-success));
      cursor: default;
      transform: scale(0.95);
    }

    .memory-card.matched::before {
      content: attr(data-emoji);
      transform: rotateY(0deg);
      background: none;
    }

    .memory-controls {
      margin-top: var(--spacing-md);
    }

    /* Reaction Tester Game */
    .reaction-game {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--spacing-lg);
      width: 100%;
      max-width: 400px;
    }

    .reaction-display {
      width: 100%;
      max-width: 300px;
      height: 150px;
      border-radius: var(--border-radius-lg);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      font-weight: 600;
      text-align: center;
      cursor: pointer;
      transition: background-color var(--transition-fast), transform var(--transition-fast);
      box-shadow: var(--shadow-sm);
      user-select: none;
    }

    .reaction-display:hover {
      transform: scale(1.02);
    }

    .reaction-ready {
      background: linear-gradient(135deg, var(--color-primary), var(--color-secondary));
      color: var(--color-on-primary);
    }

    .reaction-wait {
      background: linear-gradient(135deg, #ff9800, #f57c00);
      color: #000000;
    }

    .reaction-go {
      background: linear-gradient(135deg, #4caf50, #388e3c);
      color: var(--color-on-primary);
      animation: pulse-bg 1s infinite;
    }

    @keyframes pulse-bg {
      0% { background-size: 100% 100%; }
      50% { background-size: 110% 110%; }
      100% { background-size: 100% 100%; }
    }

    .reaction-result {
      font-size: 1.2rem;
      font-weight: 600;
      text-align: center;
      min-height: 30px;
      color: var(--color-primary);
    }

    .reaction-attempts {
      font-size: 1rem;
      opacity: 0.8;
    }

    /* Whack-a-Doodle Game */
    .whack-game {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--spacing-lg);
      width: 100%;
      max-width: 500px;
    }

    .whack-stats {
      display: flex;
      gap: var(--spacing-lg);
      font-size: 1rem;
      font-weight: 600;
      flex-wrap: wrap;
      justify-content: center;
    }

    .whack-stat-item {
      background-color: rgba(0, 0, 0, 0.03);
      padding: var(--spacing-sm) var(--spacing-md);
      border-radius: var(--border-radius-sm);
    }

    .theme-dark .whack-stat-item {
      background-color: rgba(255, 255, 255, 0.03);
    }

    .whack-board {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: var(--spacing-md);
      width: 100%;
      max-width: 350px;
    }

    .whack-hole {
      aspect-ratio: 1;
      background: radial-gradient(circle at 30% 30%, #5d4037, #3e2723);
      border-radius: 50%;
      position: relative;
      overflow: hidden;
      box-shadow: inset 0 8px 15px rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .whack-doodle {
      position: absolute;
      width: 70%;
      height: 70%;
      background: radial-gradient(circle at 30% 30%, #FFD3B6, #FFAAA5);
      border-radius: 50%;
      bottom: -100%;
      transition: bottom 0.3s ease, transform 0.1s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      border: 2px solid #d7ccc8;
    }

    .whack-doodle:hover {
      transform: scale(1.1);
    }

    .whack-doodle.up {
      bottom: 15%;
      animation: peek 0.3s ease-out;
    }

    @keyframes peek {
      0% { bottom: -100%; }
      70% { bottom: 20%; }
      100% { bottom: 15%; }
    }

    .whack-controls {
      margin-top: var(--spacing-md);
    }

    /* Dice Game */
    .dice-game {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--spacing-lg);
      width: 100%;
      max-width: 400px;
    }

    .dice-display {
      display: flex;
      gap: var(--spacing-lg);
      margin: var(--spacing-md) 0;
    }

    .dice {
      width: 80px;
      height: 80px;
      background: linear-gradient(135deg, var(--color-surface), #f0f0f0);
      border: 2px solid var(--color-primary);
      border-radius: var(--border-radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2.5rem;
      font-weight: 700;
      box-shadow: var(--shadow-sm);
    }

    .theme-dark .dice {
      background: linear-gradient(135deg, var(--color-surface), #2a2a30);
    }

    .dice-controls {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--spacing-md);
      width: 100%;
      max-width: 300px;
    }

    .dice-guess {
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
      width: 100%;
    }

    .dice-guess input {
      flex: 1;
      padding: var(--spacing-sm);
      border: 1px solid rgba(0, 0, 0, 0.2);
      border-radius: var(--border-radius-sm);
      font-size: 1rem;
      text-align: center;
      background-color: var(--color-surface);
      color: var(--color-on-surface);
    }

    .theme-dark .dice-guess input {
      border: 1px solid rgba(255, 255, 255, 0.2);
      background-color: var(--color-background);
    }

    .dice-result {
      font-size: 1.1rem;
      font-weight: 600;
      text-align: center;
      min-height: 30px;
      color: var(--color-primary);
    }

    .dice-stats {
      font-size: 1rem;
      font-weight: 600;
      text-align: center;
      margin-top: var(--spacing-sm);
    }

    /* Shaikh's Runner Game */
    .runner-game {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--spacing-lg);
      width: 100%;
      max-width: 700px;
    }

    .runner-canvas-container {
      position: relative;
      width: 100%;
      max-width: 600px;
    }

    .runner-canvas {
      background: linear-gradient(to bottom, #87CEEB, #E0F7FA);
      border-radius: var(--border-radius-md);
      box-shadow: var(--shadow-sm);
      display: block;
      width: 100%;
      height: auto;
      border: 1px solid #b2ebf2;
    }

    .theme-dark .runner-canvas {
      background: linear-gradient(to bottom, #263238, #37474f);
      border: 1px solid #455a64;
    }

    .runner-stats {
      font-size: 1.1rem;
      font-weight: 600;
      text-align: center;
      color: var(--color-primary);
    }

    .runner-controls {
      display: flex;
      gap: var(--spacing-md);
      margin-top: var(--spacing-md);
      flex-wrap: wrap;
      justify-content: center;
    }

    /* ===== Modals ===== */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: var(--z-modal);
      opacity: 0;
      visibility: hidden;
      transition: opacity var(--transition-normal), visibility var(--transition-normal);
    }

    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .modal {
      background-color: var(--color-surface);
      border-radius: var(--border-radius-lg);
      box-shadow: var(--shadow-lg);
      width: 90%;
      max-width: 500px;
      max-height: 90vh;
      overflow-y: auto;
      transform: translateY(20px);
      transition: transform var(--transition-normal);
      border: 1px solid rgba(0, 0, 0, 0.1);
    }

    .theme-dark .modal {
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .modal-overlay.active .modal {
      transform: translateY(0);
    }

    .modal-header {
      padding: var(--spacing-md);
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .theme-dark .modal-header {
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .modal-title {
      margin: 0;
      font-family: var(--font-family-heading);
      font-size: 1.5rem;
      font-weight: 400;
      color: var(--color-primary);
    }

    .modal-close {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      width: 36px;
      height: 36px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: background-color var(--transition-fast);
    }

    .modal-close:hover {
      background-color: rgba(0, 0, 0, 0.05);
    }

    .theme-dark .modal-close:hover {
      background-color: rgba(255, 255, 255, 0.05);
    }

    .modal-body {
      padding: var(--spacing-md);
    }

    .modal-footer {
      padding: var(--spacing-sm) var(--spacing-md);
      border-top: 1px solid rgba(0, 0, 0, 0.1);
      display: flex;
      justify-content: flex-end;
      gap: var(--spacing-sm);
      flex-wrap: wrap;
    }

    .theme-dark .modal-footer {
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    /* Form Elements */
    .form-group {
      margin-bottom: var(--spacing-md);
    }

    .form-label {
      display: block;
      margin-bottom: var(--spacing-xs);
      font-weight: 600;
      color: var(--color-on-surface);
    }

    .form-control {
      width: 100%;
      padding: var(--spacing-sm) var(--spacing-md);
      border-radius: var(--border-radius-md);
      border: 1px solid rgba(0, 0, 0, 0.1);
      background-color: var(--color-surface);
      color: var(--color-on-surface);
      font-family: inherit;
      font-size: 1rem;
      box-shadow: var(--shadow-sm);
    }

    .theme-dark .form-control {
      border: 1px solid rgba(255, 255, 255, 0.1);
      background-color: var(--color-background);
    }

    .form-control:focus {
      outline: none;
      box-shadow: var(--shadow-focus);
    }

    .form-control[type="range"] {
      padding: 0;
    }

    .checkbox-group {
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
    }

    .checkbox-group input {
      width: auto;
    }

    /* ===== Toasts ===== */
    .toast-container {
      position: fixed;
      bottom: var(--spacing-lg);
      right: var(--spacing-lg);
      z-index: var(--z-toast);
      display: flex;
      flex-direction: column;
      gap: var(--spacing-sm);
      max-width: 350px;
    }

    .toast {
      background-color: var(--color-surface);
      color: var(--color-on-surface);
      padding: var(--spacing-md);
      border-radius: var(--border-radius-md);
      box-shadow: var(--shadow-lg);
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
      transform: translateX(100%);
      transition: transform var(--transition-normal);
      border-left: 4px solid var(--color-primary);
    }

    .toast.show {
      transform: translateX(0);
    }

    .toast.success {
      border-left-color: var(--color-success);
    }

    .toast.error {
      border-left-color: var(--color-error);
    }

    .toast.info {
      border-left-color: var(--color-primary);
    }

    .toast-close {
      background: none;
      border: none;
      font-size: 1.2rem;
      cursor: pointer;
      margin-left: auto;
      padding: var(--spacing-xs);
      border-radius: var(--border-radius-sm);
      transition: background-color var(--transition-fast);
    }

    .toast-close:hover {
      background-color: rgba(0, 0, 0, 0.05);
    }

    .theme-dark .toast-close:hover {
      background-color: rgba(255, 255, 255, 0.05);
    }

    /* ===== Animations ===== */
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .fade-in {
      animation: fadeIn var(--transition-normal) ease-in;
    }

    /* ===== Responsive Design ===== */
    @media (max-width: 768px) {
      .game-area {
        flex-direction: column;
      }

      .game-sidebar {
        width: 100%;
        position: relative;
        top: 0;
        max-height: none;
        box-shadow: none;
        border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        border-radius: 0;
        padding: var(--spacing-md) 0;
      }

      .theme-dark .game-sidebar {
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .sidebar-header {
        padding: 0 var(--spacing-md);
      }

      .toggle-sidebar {
        display: block;
      }

      .game-sidebar.hidden {
        transform: none;
        position: relative;
        display: none;
      }

      .games-grid {
        grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
      }

      .game-view {
        height: calc(100vh - 180px);
      }
    }

    @media (max-width: 480px) {
      .header-content {
        flex-direction: column;
        gap: var(--spacing-md);
      }

      .games-grid {
        grid-template-columns: 1fr;
      }

      .game-icon {
        width: 60px;
        height: 60px;
        font-size: 1.8rem;
      }

      .game-title {
        font-size: 1.1rem;
      }

      .tictactoe-cell {
        font-size: 2rem;
      }

      .memory-card {
        font-size: 1.5rem;
      }

      .memory-card::before {
        font-size: 1.5rem;
      }

      .dice {
        width: 70px;
        height: 70px;
        font-size: 2rem;
      }

      .reaction-display {
        height: 120px;
        font-size: 1.2rem;
      }
    }

    /* Accessibility */
    @media (prefers-reduced-motion: reduce) {
      * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
      
      .doodle-bg {
        display: none;
      }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="header-content">
      <a href="#" class="logo" id="logo">
        <span class="logo-icon">üé™</span>
        <span>Shaikh's Enhanced Arcade</span>
      </a>
      <div class="header-controls">
        <button class="icon-button" id="soundToggle" aria-label="Toggle sound">üîä</button>
        <button class="icon-button" id="themeToggle" aria-label="Toggle theme">‚òÄÔ∏è</button>
        <button class="icon-button" id="settingsButton" aria-label="Settings">‚öôÔ∏è</button>
        <button class="icon-button" id="profileButton" aria-label="Profile">üë§</button>
      </div>
    </div>
    <div class="search-container">
      <div class="search-icon">üîç</div>
      <input type="text" class="search-input" id="gameSearch" placeholder="Search games..." aria-label="Search games">
    </div>
  </header>

  <!-- Main Layout -->
  <div class="container">
    <div class="game-area">
      <!-- Sidebar -->
      <aside class="game-sidebar" id="gameSidebar">
        <div class="sidebar-header">
          <h2 class="sidebar-title">Games</h2>
          <button class="toggle-sidebar" id="toggleSidebar" aria-label="Toggle game list">‚ò∞</button>
        </div>
        <ul class="games-list" id="gamesList">
          <!-- Game list items will be populated by JavaScript -->
        </ul>
      </aside>

      <!-- Main Content -->
      <main class="games-main-content">
        <div class="games-grid" id="gamesGrid">
          <!-- Game tiles will be populated by JavaScript -->
        </div>
      </main>
    </div>

    <!-- Game View -->
    <div class="game-view" id="gameView">
      <div class="game-header">
        <div class="game-title-bar">
          <button class="btn btn-secondary" id="backButton">‚Üê Back</button>
          <h2 class="game-title" id="currentGameTitle">Game Title</h2>
        </div>
        <div class="game-controls">
          <button class="icon-button" id="gameInfo" aria-label="Game information">‚ÑπÔ∏è</button>
          <button class="icon-button" id="gameRestart" aria-label="Restart game">üîÑ</button>
          <button class="icon-button" id="gamePause" aria-label="Pause game">‚è∏Ô∏è</button>
        </div>
      </div>
      <div class="game-content" id="gameContent" tabindex="-1">
        <!-- Game content will be populated by JavaScript -->
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div class="modal-overlay" id="settingsModal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">Settings</h3>
        <button class="modal-close" id="closeSettings">‚úï</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label class="form-label" for="soundToggleSetting">Sound</label>
          <div class="form-control">
            <label>
              <input type="checkbox" id="soundToggleSetting">
              Enable sound
            </label>
          </div>
        </div>
        <div class="form-group">
          <label class="form-label" for="volumeSlider">Volume</label>
          <input type="range" id="volumeSlider" min="0" max="1" step="0.1" class="form-control">
        </div>
        <div class="form-group">
          <label class="form-label" for="themeSelect">Theme</label>
          <select id="themeSelect" class="form-control">
            <option value="light">Light</option>
            <option value="dark">Dark</option>
            <option value="auto">Auto (system)</option>
          </select>
        </div>
        <div class="form-group">
          <label class="form-label" for="onboardingToggle">Show onboarding</label>
          <div class="form-control">
            <label>
              <input type="checkbox" id="onboardingToggle">
              Show onboarding on startup
            </label>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" id="resetProgress">Reset Progress</button>
        <button class="btn btn-primary" id="saveSettings">Save</button>
      </div>
    </div>
  </div>

  <!-- Profile Modal -->
  <div class="modal-overlay" id="profileModal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">Your Profile</h3>
        <button class="modal-close" id="closeProfile">‚úï</button>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <h4>Achievements</h4>
          <div id="achievementsList">
            <!-- Achievements will be populated by JavaScript -->
          </div>
        </div>
        <div class="form-group">
          <h4>High Scores</h4>
          <div id="highScoresList">
            <!-- High scores will be populated by JavaScript -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Onboarding Modal -->
  <div class="modal-overlay" id="onboardingModal">
    <div class="modal">
      <div class="modal-header">
        <h3 class="modal-title">Welcome to Shaikh's Enhanced Arcade!</h3>
        <button class="modal-close" id="closeOnboarding">‚úï</button>
      </div>
      <div class="modal-body">
        <div style="text-align: center; margin-bottom: var(--spacing-xl);">
          <div style="font-size: 4rem; margin-bottom: var(--spacing-md);">üéâ</div>
          <h3 style="margin-bottom: var(--spacing-md); font-family: var(--font-family-heading);">Ready for Some Fun?</h3>
          <p style="margin-bottom: var(--spacing-sm);">üéÆ Play a collection of fun, upgraded mini-games</p>
          <p style="margin-bottom: var(--spacing-sm);">üèÜ Earn achievements and track high scores</p>
          <p style="margin-bottom: var(--spacing-sm);">‚öôÔ∏è Customize your experience in settings</p>
          <p style="margin-bottom: var(--spacing-sm);">üåô Try the new dark theme!</p>
          <p style="margin-bottom: var(--spacing-sm);">‚ú® Experience the new theme and creative details!</p>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" id="startPlaying">Start Playing</button>
      </div>
    </div>
  </div>

  <!-- Toast Container -->
  <div class="toast-container" id="toastContainer">
    <!-- Toasts will be added here by JavaScript -->
  </div>

  <script>
    /* ===== SCRIPTS - Enhanced with New Theme and Fixed Games ===== */
    (function() {
      'use strict';

      // Utility functions
      const qs = (selector, root = document) => root.querySelector(selector);
      const qsa = (selector, root = document) => Array.from(root.querySelectorAll(selector));
      const create = (tag, props = {}, children = []) => {
        const el = document.createElement(tag);
        Object.keys(props).forEach(key => {
          el[key] = props[key];
        });
        children.forEach(child => {
          if (typeof child === 'string') {
            el.appendChild(document.createTextNode(child));
          } else {
            el.appendChild(child);
          }
        });
        return el;
      };

      // App state
      let activeGame = null;
      let activeGameId = null;
      let gamesRegistry = {};
      let settings = {
        soundOn: true,
        volume: 0.5,
        theme: 'light',
        showOnboarding: true
      };
      let scores = {};
      let achievements = {};

      // Storage utilities
      const Storage = {
        get(key) {
          try {
            const item = localStorage.getItem(`shaikhArcadeEnhanced.${key}`);
            return item ? JSON.parse(item) : null;
          } catch (e) {
            console.error('Error reading from localStorage', e);
            return null;
          }
        },
        set(key, value) {
          try {
            localStorage.setItem(`shaikhArcadeEnhanced.${key}`, JSON.stringify(value));
          } catch (e) {
            console.error('Error writing to localStorage', e);
          }
        },
        remove(key) {
          try {
            localStorage.removeItem(`shaikhArcadeEnhanced.${key}`);
          } catch (e) {
            console.error('Error removing from localStorage', e);
          }
        }
      };

      // Load/Save data
      function loadData() {
        const savedSettings = Storage.get('settings');
        if (savedSettings) settings = { ...settings, ...savedSettings };

        const savedScores = Storage.get('scores');
        if (savedScores) scores = savedScores;

        const savedAchievements = Storage.get('achievements');
        if (savedAchievements) achievements = savedAchievements;

        applySettings();
      }

      function saveData() {
        Storage.set('settings', settings);
        Storage.set('scores', scores);
        Storage.set('achievements', achievements);
      }

      function updateScores(gameId, newScores) {
        if (!scores[gameId]) scores[gameId] = {};
        scores[gameId] = { ...scores[gameId], ...newScores };
        saveData();
      }

      function checkAchievement(id, condition, data = {}) {
        if (condition && !achievements[id]) {
          achievements[id] = {
            timestamp: Date.now(),
            ...data
          };
          saveData();
          let message = '';
          switch (id) {
            case 'first_game': message = 'Achievement Unlocked: First Game!'; break;
            case 'snake_master': message = 'Achievement Unlocked: Snake Master!'; break;
            case 'tic_master': message = 'Achievement Unlocked: Tic-Tac-Toe Master!'; break;
            case 'memory_champ': message = 'Achievement Unlocked: Memory Champion!'; break;
            case 'speed_demon': message = 'Achievement Unlocked: Speed Demon!'; break;
            case 'whack_streak': message = 'Achievement Unlocked: Whack-a-Doodle Streak!'; break;
            case 'lucky_roller': message = 'Achievement Unlocked: Lucky Roller!'; break;
            case 'runner_pro': message = 'Achievement Unlocked: Runner Pro!'; break;
          }
          if (message) Toast.show(message, 'success');
        }
      }

      // Toast notifications
      const Toast = {
        show(message, type = 'info') {
          const container = qs('#toastContainer');
          const toast = create('div', {
            className: `toast ${type}`,
            innerHTML: `
              <span>${message}</span>
              <button class="toast-close">√ó</button>
            `
          });

          const closeBtn = qs('.toast-close', toast);
          closeBtn.addEventListener('click', () => {
            toast.classList.remove('show');
            setTimeout(() => {
              container.removeChild(toast);
            }, 300);
          });

          container.appendChild(toast);
          setTimeout(() => toast.classList.add('show'), 10);

          setTimeout(() => {
            toast.classList.remove('show');
            setTimeout(() => {
              if (container.contains(toast)) {
                container.removeChild(toast);
              }
            }, 300);
          }, 5000);
        }
      };

      // Sound Manager (Simplified version)
      const SoundManager = {
        audioContext: null,
        enabled: true,
        volume: 0.5,

        init() {
          try {
            this.audioContext = new (window.AudioContext || window.webkitAudioContext)();
            this.enabled = true;
          } catch (e) {
            console.warn('Web Audio API is not supported in this browser');
            this.enabled = false;
          }
        },

        play(kind) {
          if (!this.enabled || !this.audioContext || !settings.soundOn) return;

          const oscillator = this.audioContext.createOscillator();
          const gainNode = this.audioContext.createGain();

          oscillator.connect(gainNode);
          gainNode.connect(this.audioContext.destination);

          let frequency = 440;
          let duration = 0.1;

          switch (kind) {
            case 'click': frequency = 523.25; break;
            case 'success': frequency = 783.99; break;
            case 'error': frequency = 349.23; break;
            case 'eat': frequency = 659.25; duration = 0.05; break;
            case 'hit': frequency = 392; duration = 0.08; break;
          }

          gainNode.gain.value = this.volume;
          oscillator.frequency.value = frequency;
          oscillator.type = 'sine';
          oscillator.start();
          gainNode.gain.exponentialRampToValueAtTime(0.001, this.audioContext.currentTime + duration);
        }
      };

      // Apply settings
      function applySettings() {
        // Theme
        if (settings.theme === 'dark') {
          document.body.classList.add('theme-dark');
          qs('#themeToggle').textContent = 'üåô';
          qs('#themeSelect').value = 'dark';
        } else if (settings.theme === 'auto') {
          const isDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
          if (isDark) {
            document.body.classList.add('theme-dark');
            qs('#themeToggle').textContent = 'üåô';
          } else {
            document.body.classList.remove('theme-dark');
            qs('#themeToggle').textContent = '‚òÄÔ∏è';
          }
          qs('#themeSelect').value = 'auto';
        } else {
          document.body.classList.remove('theme-dark');
          qs('#themeToggle').textContent = '‚òÄÔ∏è';
          qs('#themeSelect').value = 'light';
        }

        // Sound
        qs('#soundToggle').textContent = settings.soundOn ? 'üîä' : 'üîá';
        qs('#soundToggleSetting').checked = settings.soundOn;
        qs('#volumeSlider').value = settings.volume;
        SoundManager.volume = settings.volume;

        // Onboarding
        qs('#onboardingToggle').checked = settings.showOnboarding;
      }

      // Ripple effect for buttons
      function addRippleEffect(element) {
        element.addEventListener('click', function(e) {
          const ripple = document.createElement('span');
          const rect = this.getBoundingClientRect();
          const size = Math.max(rect.width, rect.height);
          const x = e.clientX - rect.left - size / 2;
          const y = e.clientY - rect.top - size / 2;

          ripple.style.width = ripple.style.height = `${size}px`;
          ripple.style.left = `${x}px`;
          ripple.style.top = `${y}px`;
          ripple.classList.add('ripple');

          this.appendChild(ripple);

          setTimeout(() => {
            ripple.remove();
          }, 600);
        });
      }

      // Create game preview
      function createGamePreview(gameId) {
        const preview = create('div', { className: 'game-preview' });
        switch (gameId) {
          case 'snake':
            preview.textContent = 'üêç Eat food, avoid walls!';
            break;
          case 'tictactoe':
            preview.textContent = '‚≠ï Classic X and O game';
            break;
          case 'memory':
            preview.textContent = 'üß† Match pairs of cards';
            break;
          case 'reaction':
            preview.textContent = '‚è±Ô∏è Test your reaction speed';
            break;
          case 'whack':
            preview.textContent = 'üî® Whack the doodles!';
            break;
          case 'dice':
            preview.textContent = 'üé≤ Guess numbers and roll dice';
            break;
          case 'runner':
            preview.textContent = 'üèÉ Endless runner game';
            break;
          default:
            preview.textContent = 'üéÆ Mini-game preview';
        }
        return preview;
      }

      // Render games grid (Home page)
      function renderGamesGrid() {
        gamesGrid.innerHTML = '';
        for (const gameId in gamesRegistry) {
          const game = gamesRegistry[gameId];
          const tile = create('div', {
            className: 'game-tile',
            onclick: () => openGame(gameId)
          }, [
            create('div', { className: 'game-icon', innerHTML: game.icon }),
            create('h3', { className: 'game-title', textContent: game.title }),
            create('p', { className: 'game-description', textContent: game.description }),
            createGamePreview(gameId)
          ]);
          gamesGrid.appendChild(tile);
          addRippleEffect(tile);
        }
      }

      // Render game list (Sidebar)
      function renderGameList() {
        gamesList.innerHTML = '';
        for (const gameId in gamesRegistry) {
          const game = gamesRegistry[gameId];
          const listItem = create('li', {
            className: 'game-list-item',
            onclick: () => openGame(gameId)
          }, [
            create('span', { className: 'game-list-icon', innerHTML: game.icon }),
            create('span', { className: 'game-list-text', textContent: game.title })
          ]);
          gamesList.appendChild(listItem);
          if (gameId === activeGameId) {
            listItem.classList.add('active');
          }
        }
      }

      // Update active game highlight in sidebar
      function updateActiveGameHighlight(gameId) {
        activeGameId = gameId;
        qsa('.game-list-item', gamesList).forEach(item => {
          item.classList.remove('active');
          if (item.querySelector('.game-list-text').textContent === gamesRegistry[gameId]?.title) {
            item.classList.add('active');
          }
        });
      }

      // Open a game
      function openGame(gameId) {
        const game = gamesRegistry[gameId];
        if (!game) return;

        if (activeGame) {
          activeGame.destroy();
          activeGame = null;
        }

        currentGameTitle.textContent = game.title;
        gameContent.innerHTML = '';
        gameView.classList.add('active');
        activeGame = game.init(gameContent);
        gameContent.setAttribute('tabindex', '-1');
        gameContent.focus();
        SoundManager.play('click');
        updateActiveGameHighlight(gameId);

        if (window.innerWidth <= 768) {
          gameSidebar.classList.add('hidden');
        }
      }

      // Close the current game
      function closeGame() {
        if (activeGame) {
          activeGame.destroy();
          activeGame = null;
        }
        gameView.classList.remove('active');
        gamesGrid.setAttribute('tabindex', '-1');
        gamesGrid.focus();
        activeGameId = null;
        updateActiveGameHighlight(null);
      }

      // Register games
      function registerGames() {
        gamesRegistry = {
          // Snake Game
          snake: {
            id: 'snake',
            title: 'Snake Game',
            description: 'Classic snake game. Eat food and grow without hitting walls or yourself!',
            icon: 'üêç',
            init(container) {
              // Game state
              const gameState = {
                snake: [{ x: 10, y: 10 }],
                direction: 'right',
                nextDirection: 'right',
                food: { x: 5, y: 5 },
                score: 0,
                highScore: scores.snake?.highScore || 0,
                gameOver: false,
                paused: false,
                level: 1,
                baseSpeed: 150,
                speed: 150,
                foodEatenThisLevel: 0,
                lastUpdate: 0,
                interpolation: 0,
                gridSize: 20,
                canvasWidth: 400,
                canvasHeight: 400
              };

              // Create game elements
              const gameUI = create('div', { className: 'snake-game' });
              const canvasContainer = create('div', { className: 'snake-canvas-container' });
              const canvas = create('canvas', {
                className: 'snake-canvas',
                width: gameState.canvasWidth,
                height: gameState.canvasHeight
              });
              const ctx = canvas.getContext('2d');
              canvasContainer.appendChild(canvas);
              const scoreAnnouncer = create('div', { className: 'snake-announcer' });

              // Stats display
              const statsDiv = create('div', { className: 'snake-stats' });
              const scoreSpan = create('span', { className: 'snake-stat-item', textContent: `Score: ${gameState.score}` });
              const highScoreSpan = create('span', { className: 'snake-stat-item', textContent: `High Score: ${gameState.highScore}` });
              const levelSpan = create('span', { className: 'snake-level-display', textContent: `Level: ${gameState.level}` });
              statsDiv.append(scoreSpan, highScoreSpan, levelSpan);

              gameUI.append(statsDiv, canvasContainer, scoreAnnouncer);
              container.appendChild(gameUI);

              // Place food at random position
              const placeFood = () => {
                let newFood, overlapping;
                do {
                  newFood = {
                    x: Math.floor(Math.random() * (gameState.canvasWidth / gameState.gridSize)),
                    y: Math.floor(Math.random() * (gameState.canvasHeight / gameState.gridSize))
                  };
                  overlapping = gameState.snake.some(segment => segment.x === newFood.x && segment.y === newFood.y);
                } while (overlapping);
                gameState.food = newFood;
              };

              // Check collision
              const checkCollision = (head) => {
                // Wall collision
                if (head.x < 0 || head.x >= gameState.canvasWidth / gameState.gridSize || head.y < 0 || head.y >= gameState.canvasHeight / gameState.gridSize) {
                  return true;
                }
                // Self collision
                for (let i = 0; i < gameState.snake.length; i++) {
                  if (gameState.snake[i].x === head.x && gameState.snake[i].y === head.y) {
                    return true;
                  }
                }
                return false;
              };

              // Level up
              const levelUp = () => {
                gameState.level++;
                gameState.speed = Math.max(50, gameState.baseSpeed - (gameState.level - 1) * 10);
                gameState.foodEatenThisLevel = 0;
                levelSpan.textContent = `Level: ${gameState.level}`;
                scoreAnnouncer.textContent = `Level ${gameState.level}!`;
              };

              // Game loop
              const update = (timestamp) => {
                if (gameState.paused || gameState.gameOver) return;

                // Calculate delta time for smooth movement
                if (!gameState.lastUpdate) gameState.lastUpdate = timestamp;
                const deltaTime = timestamp - gameState.lastUpdate;
                gameState.lastUpdate = timestamp;
                gameState.interpolation += deltaTime;

                // Update game state at fixed intervals
                while (gameState.interpolation >= gameState.speed) {
                  // Update direction
                  gameState.direction = gameState.nextDirection;

                  // Calculate new head position
                  const head = { ...gameState.snake[0] };
                  switch (gameState.direction) {
                    case 'up': head.y--; break;
                    case 'down': head.y++; break;
                    case 'left': head.x--; break;
                    case 'right': head.x++; break;
                  }

                  // Check collision
                  if (checkCollision(head)) {
                    gameState.gameOver = true;
                    if (gameState.score > gameState.highScore) {
                      gameState.highScore = gameState.score;
                      updateScores('snake', { highScore: gameState.highScore });
                      highScoreSpan.textContent = `High Score: ${gameState.highScore}`;
                      checkAchievement('snake_master', gameState.highScore >= 50, { score: gameState.highScore });
                    }
                    scoreAnnouncer.textContent = 'Game Over! Press Space to restart';
                    return;
                  }

                  // Add new head
                  gameState.snake.unshift(head);

                  // Check food collision
                  if (head.x === gameState.food.x && head.y === gameState.food.y) {
                    // Increase score
                    gameState.score += 10 * gameState.level;
                    scoreSpan.textContent = `Score: ${gameState.score}`;
                    SoundManager.play('eat');

                    // Place new food
                    placeFood();

                    // Level progress
                    gameState.foodEatenThisLevel++;
                    if (gameState.foodEatenThisLevel >= 5) {
                      levelUp();
                    }
                  } else {
                    // Remove tail if no food eaten
                    gameState.snake.pop();
                  }

                  gameState.interpolation -= gameState.speed;
                }

                // Draw everything
                // Clear canvas
                ctx.fillStyle = getComputedStyle(document.body).getPropertyValue('--color-background');
                ctx.fillRect(0, 0, gameState.canvasWidth, gameState.canvasHeight);

                // Draw grid
                ctx.strokeStyle = 'rgba(0, 0, 0, 0.05)';
                ctx.lineWidth = 0.5;
                for (let i = 0; i <= gameState.canvasWidth / gameState.gridSize; i++) {
                  ctx.beginPath();
                  ctx.moveTo(i * gameState.gridSize, 0);
                  ctx.lineTo(i * gameState.gridSize, gameState.canvasHeight);
                  ctx.stroke();
                  
                  ctx.beginPath();
                  ctx.moveTo(0, i * gameState.gridSize);
                  ctx.lineTo(gameState.canvasWidth, i * gameState.gridSize);
    
